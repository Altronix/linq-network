cmake_minimum_required(VERSION 3.11)
project(linq-c)


# dependency install
include(${CMAKE_ROOT}/Modules/ExternalProject.cmake)
find_package(Threads)
set(deps_INSTALL_DIR ${CMAKE_CURRENT_BINARY_DIR}/install)
file(MAKE_DIRECTORY ${deps_INSTALL_DIR}/include)
include(cmake/libzmq.cmake)
include(cmake/czmq.cmake)
include(cmake/klib.cmake)
include(cmake/jsmn.cmake)

add_subdirectory(src)
add_subdirectory(bindings/cpp)

IF(ENABLE_TESTING)
	set(CMAKE_BUILD_TYPE Debug)
    	enable_testing()
    	include(CTest)
	include(cmake/cmocka.cmake)
	include(cmake/test-fixture.cmake)
	add_subdirectory(test/_helpers)
	add_subdirectory(test/_fixture)
	add_subdirectory(test/_mocks)
	add_subdirectory(test/linq)
	add_subdirectory(test/device)
	add_subdirectory(test/device_map)
	add_subdirectory(test/requests)
	add_subdirectory(test/integration)
	add_subdirectory(bindings/cpp/test)
ENDIF()
